(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ac5bb2be"],{"03ca":function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return c}));var r=n("b7e2"),o=n("4328"),i=n.n(o);function s(e){return Object(r["a"])({url:"/OrderInventory/GetOrderInventory",method:"get",params:e})}function a(e){return Object(r["a"])({url:"/OrderInventory/GetOrderInventoryByID",method:"get",params:e})}function l(e){return Object(r["a"])({url:"/OrderInventory/Create",method:"post",data:i.a.stringify(e)})}function c(e){return Object(r["a"])({url:"/OrderInventory/Edit",method:"post",data:i.a.stringify(e)})}},"3ef2":function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("el-form",{ref:"tempForm",staticClass:"demo-ruleForm",attrs:{model:e.tempForm,rules:e.rules,"label-position":"top","label-width":"70px"}},[n("el-card",{staticClass:"box-card"},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("el-button",{staticStyle:{float:"left"},attrs:{type:" ",icon:"fa fa-save"},on:{click:function(t){1!=e.isEdit?e.createData():e.updateData()}}},[e._v(e._s(1!=e.isEdit?"حفظ":"تعديل"))]),e._v(" "),n("router-link",{staticClass:"pan-btn tiffany-btn",staticStyle:{float:"left","margin-left":"20px",padding:"10px 15px","border-radius":"6px"},attrs:{icon:"el-icon-plus",to:"/OrderInventories/List"}},[e._v(e._s(e.$t("route.OrderInventory")))]),e._v(" "),n("span",[e._v(e._s(e.$t("OrderInventories.StoreMovement")))]),e._v(" "),n("p",{staticStyle:{color:"#F56C6Cfont-size: 16pxtext-align: center"}},[e._v(e._s(e.ValidateNote))])],1),e._v(" "),n("el-row",{attrs:{type:"flex"}},[n("el-col",{attrs:{span:6}},[n("el-form-item",{attrs:{prop:"OrderType",label:e.$t("OrderInventories.OrderType"),rules:[{required:!0,message:"يجب تحديد نوع سند",trigger:"blur"}]}},[n("el-radio-group",{model:{value:e.tempForm.OrderType,callback:function(t){e.$set(e.tempForm,"OrderType",t)},expression:"tempForm.OrderType"}},[n("el-radio-button",{attrs:{label:"ادخال بضاعة اول المدة / بونص"}}),e._v(" "),n("el-radio-button",{attrs:{label:"اخراج: هدايا / عروض / تالف"}})],1)],1)],1),e._v(" "),n("el-col",{attrs:{span:6}},[n("el-form-item",{attrs:{prop:"FakeDate",label:e.$t("NewPurchaseInvoice.ReleaseDate"),rules:[{required:!0,message:"لايمكن ترك التاريخ فارغ",trigger:"blur"}]}},[n("el-date-picker",{attrs:{type:"date",placeholder:e.$t("Sales.Date"),format:"dd/MM/yyyy"},model:{value:e.tempForm.FakeDate,callback:function(t){e.$set(e.tempForm,"FakeDate",t)},expression:"tempForm.FakeDate"}})],1)],1),e._v(" "),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{prop:"description",label:e.$t("OrderInventories.Statement")}},[n("el-input",{attrs:{type:"textarea"},model:{value:e.tempForm.Description,callback:function(t){e.$set(e.tempForm,"Description",t)},expression:"tempForm.Description"}})],1)],1)],1),e._v(" "),n("el-card",{staticStyle:{background:"#545454"},attrs:{"body-style":{padding:"1px"}}},[n("items-search",{on:{add:e.AddItem}})],1),e._v(" "),n("el-form-item",{attrs:{prop:"InventoryMovements"}},[n("el-table",{attrs:{data:e.tempForm.InventoryMovements,fit:"",border:"","max-height":"350","highlight-current-row":""}},[n("el-table-column",{attrs:{align:"center"},scopedSlots:e._u([{key:"header",fn:function(t){return[e._v(e._s(e.$t("OrderInventories.Items"))+" ("+e._s(e.tempForm.InventoryMovements.length.toFixed(2))+")")]}},{key:"default",fn:function(t){return[e._v("\n              "+e._s(e.tempForm.InventoryMovements[t.$index].Itemx.name)+"\n              "),n("edit-item",{attrs:{ItemID:e.tempForm.InventoryMovements[t.$index].ItemsID}})]}}])}),e._v(" "),n("el-table-column",{attrs:{width:"150",align:"center"},scopedSlots:e._u([{key:"header",fn:function(t){return[e._v(e._s(e.$t("CashPool.quantity"))+" ("+e._s(e.tempForm.InventoryMovements.reduce((function(e,t){return e+(t["Qty"]||0)}),0).toFixed(2))+")")]}},{key:"default",fn:function(t){return[n("el-input-number",{attrs:{"controls-position":"right",precision:2,step:1,min:0,max:1e6},model:{value:e.tempForm.InventoryMovements[t.$index].Qty,callback:function(n){e.$set(e.tempForm.InventoryMovements[t.$index],"Qty",n)},expression:"tempForm.InventoryMovements[scope.$index].Qty"}})]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center"},scopedSlots:e._u([{key:"header",fn:function(t){return[e._v("نوع الحركة")]}},{key:"default",fn:function(t){return[n("el-radio-group",{model:{value:e.tempForm.InventoryMovements[t.$index].TypeMove,callback:function(n){e.$set(e.tempForm.InventoryMovements[t.$index],"TypeMove",n)},expression:"tempForm.InventoryMovements[scope.$index].TypeMove"}},[n("el-radio-button",{attrs:{label:"In"}},[e._v("إضافة")]),e._v(" "),n("el-radio-button",{attrs:{label:"Out"}},[e._v("حسب")])],1)]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center"},scopedSlots:e._u([{key:"header",fn:function(t){return[e._v(e._s(e.$t("OrderInventories.Store")))]}},{key:"default",fn:function(t){return[n("el-radio-group",{model:{value:e.tempForm.InventoryMovements[t.$index].InventoryItemID,callback:function(n){e.$set(e.tempForm.InventoryMovements[t.$index],"InventoryItemID",n)},expression:"tempForm.InventoryMovements[scope.$index].InventoryItemID"}},e._l(e.InventoryItems,(function(t,r){return n("el-radio-button",{key:r,attrs:{label:t.value}},[e._v(e._s(t.label))])})),1)]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:e.$t("Vendors.Description"),width:"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-form-item",{attrs:{prop:"InventoryMovements."+t.$index+".Description"}},[n("el-input",{staticClass:"input-with-select",attrs:{required:""},model:{value:e.tempForm.InventoryMovements[t.$index].Description,callback:function(n){e.$set(e.tempForm.InventoryMovements[t.$index],"Description",n)},expression:"tempForm.InventoryMovements[scope.$index].Description"}},[n("template",{slot:"prepend"},[n("el-button",{attrs:{icon:"fa fa-copy"},on:{click:function(n){return e.Copy(t.row.Description)}}})],1),e._v(" "),n("template",{slot:"append"},[n("el-button",{attrs:{icon:"fa fa-paste"},on:{click:function(n){return e.Paste(t.$index)}}})],1)],2)],1)]}}])}),e._v(" "),n("el-table-column",{attrs:{width:"55"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(n){return e.RemoveItem(t.$index)}}})]}}])})],1)],1)],1)],1)],1)},o=[],i=(n("a481"),n("03ca")),s=n("f815"),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("img",{staticStyle:{display:"none"},attrs:{id:"barcodeV"}}),e._v(" "),n("el-row",{attrs:{type:"flex"}},[n("el-col",{attrs:{span:10}},[n("el-input",{attrs:{"data-barcode":"",id:"barcode",placeholder:"باركود صنف"},model:{value:e.Barcode,callback:function(t){e.Barcode=t},expression:"Barcode"}},[n("i",{staticClass:"fa fa-barcode el-input__icon",attrs:{slot:"suffix"},slot:"suffix"})])],1),e._v(" "),n("el-col",{staticStyle:{"margin-right":"10px"},attrs:{span:12}},[n("el-select",{ref:"headerSearchSelect",staticStyle:{display:"unset"},attrs:{"remote-method":e.querySearch,filterable:"","default-first-option":"",remote:"",placeholder:"بحث حسب اسم الصنف"},on:{change:e.change},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}},e._l(e.options,(function(t){return n("el-option",{key:t.id,attrs:{value:t,label:t.name}},[n("span",{staticStyle:{color:"#8492a6","font-size":"12px"}},[e._v("( "+e._s(t.id)+" )")]),e._v(" "),n("span",{staticStyle:{float:"left"}},[e._v(e._s(t.name))]),e._v(" "),n("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(t.SellingPrice))])])})),1)],1),e._v(" "),n("el-col",{staticStyle:{"margin-right":"10px"},attrs:{span:2}},[n("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:e.ByQTY,callback:function(t){e.ByQTY=t},expression:"ByQTY"}})],1)],1),e._v(" "),n("el-dialog",{staticStyle:{"margin-top":"-13vh"},attrs:{"show-close":!1,title:"صنف جديد",visible:e.NewItemVisible},on:{"update:visible":function(t){e.NewItemVisible=t}}},[n("el-row",{attrs:{type:"flex"}},[n("el-col",{attrs:{span:3}},[n("el-button",{attrs:{type:"success",icon:"el-plus"},on:{click:function(t){return e.NewItem()}}},[e._v("حفظ")])],1),e._v(" "),n("el-col",{attrs:{span:5}},[n("el-form-item",{attrs:{label:"سعر البيع"}},[n("el-input-number",{attrs:{precision:2,step:.1,min:0,max:1500},model:{value:e.SellingPrice,callback:function(t){e.SellingPrice=t},expression:"SellingPrice"}})],1)],1),e._v(" "),n("el-col",{attrs:{span:9}},[n("el-form-item",{attrs:{label:"باركود"}},[n("el-input",{attrs:{"suffix-icon":"fa fa-barcode"},model:{value:e.Barcode,callback:function(t){e.Barcode=t},expression:"Barcode"}})],1)],1),e._v(" "),n("el-col",{attrs:{span:6}},[n("el-form-item",{attrs:{label:"إسم صنف"}},[n("el-input",{attrs:{type:"text",placeholder:"إسم صنف"},model:{value:e.Name,callback:function(t){e.Name=t},expression:"Name"}})],1)],1)],1)],1),e._v(" "),n("el-dialog",{staticStyle:{"margin-top":"-13vh"},attrs:{title:"QTY",visible:e.EnterQTYVisible,width:"80%"},on:{"update:visible":function(t){e.EnterQTYVisible=t}}},[n("el-row",{attrs:{type:"flex"}},[n("el-col",{attrs:{span:3}},[n("el-button",{attrs:{type:"success",icon:"el-plus"},on:{click:e.AddItemByQty}},[e._v("Add")])],1),e._v(" "),n("el-col",{attrs:{span:12}},[n("el-input-number",{attrs:{precision:2,step:1,min:0,max:1e6},model:{value:e.Qty,callback:function(t){e.Qty=t},expression:"Qty"}})],1)],1)],1)],1)},l=[],c=(n("7f7f"),n("7514"),n("20d6"),n("386d"),n("ffe7")),m=n.n(c),u=n("e225"),p=n("4360"),d={name:"ItemsSearch",data:function(){return{ByQTY:!1,Qty:1,SellingPrice:0,NewItemVisible:!1,EnterQTYVisible:!1,Barcode:"",Name:"",search:"",options:[],searchPool:[],fuse:void 0}},computed:{Items:function(){return this.$store.getters.AllItems}},watch:{Items:function(){this.searchPool=this.Items},searchPool:function(e){this.initFuse(e)}},mounted:function(){this.searchPool=this.Items,this.focusBarcode()},methods:{AddItem:function(e,t){this.$emit("add",e,t),this.Barcode="",this.Qty=1},change:function(e){this.AddItem(e,1),this.search="",this.options=[]},initFuse:function(e){this.fuse=new m.a(e,{shouldSort:!0,threshold:.4,location:0,distance:100,maxPatternLength:32,minMatchCharLength:1,keys:[{name:"ID",weight:.7},{name:"Name",weight:.3}]})},querySearch:function(e){this.options=""!==e?this.fuse.search(e):[]},focusBarcode:function(){document.getElementById("barcode").focus()},resetBarcode:function(){this.$barcodeScanner.getPreviousCode()},AddItemByQty:function(){var e=this,t=this.Items.findIndex((function(t){return t.Barcode==e.$barcodeScanner.getPreviousCode()}));-1!=t?(this.AddItem(this.Items[t],this.Qty),this.EnterQTYVisible=!1):(this.EnterQTYVisible=!1,this.NewItemVisible=!0)},onBarcodeScanned:function(e){var t=this;if(this.ByQTY)this.EnterQTYVisible=!0;else{var n=this.Items.findIndex((function(e){return e.Barcode==t.Barcode||e.id==t.Barcode}));-1!=n?this.AddItem(this.Items[n],1):(this.NewItemVisible=!0,this.EnterQTYVisible=!1)}},NewItem:function(){var e=this;Object(u["a"])({ID:void 0,Name:this.name,CostPrice:0,SellingPrice:this.SellingPrice,OtherPrice:0,LowOrder:0,Tax:0,Rate:0,Barcode:this.Barcode,Description:"",Status:0}).then((function(t){e.Barcode="",e.name="",e.NewItemVisible=!1,e.$notify({title:"تم ",message:"تم الإضافة بنجاح",type:"success",duration:2e3}),p["a"].dispatch("Items/GetItem"),e.focusBarcode()})).catch((function(e){console.log(e)}))}},created:function(){this.$barcodeScanner.init(this.onBarcodeScanned)}},f=d,v=n("2877"),h=Object(v["a"])(f,a,l,!1,null,null,null),b=h.exports,y=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-button",{attrs:{icon:"el-icon-edit",circle:""},on:{click:function(t){return e.getdata()}}}),e._v(" "),n("el-dialog",{staticStyle:{"margin-top":"-13vh"},attrs:{"show-close":!1,title:"تعديل صنف",visible:e.Visibles},on:{"update:visible":function(t){e.Visibles=t}}},[n("el-form",{ref:"dataForm",attrs:{rules:e.rulesForm,model:e.tempForm,"label-position":"top","label-width":"70px"}},[n("el-form-item",{attrs:{label:e.$t("Items.ItemName"),prop:"name"}},[n("el-input",{attrs:{type:"text"},model:{value:e.tempForm.name,callback:function(t){e.$set(e.tempForm,"name",t)},expression:"tempForm.name"}})],1),e._v(" "),n("el-checkbox",{model:{value:e.tempForm.IsPrime,callback:function(t){e.$set(e.tempForm,"IsPrime",t)},expression:"tempForm.IsPrime"}},[e._v("اظهار على شاشة المبيعات")]),e._v(" "),n("el-row",{attrs:{type:"flex"}},[n("el-col",{attrs:{span:8}},[n("el-form-item",{attrs:{label:e.$t("Items.Cost"),prop:"CostPrice"}},[n("el-input-number",{attrs:{precision:2,step:.1,min:0,max:1500},model:{value:e.tempForm.CostPrice,callback:function(t){e.$set(e.tempForm,"CostPrice",t)},expression:"tempForm.CostPrice"}})],1)],1),e._v(" "),n("el-col",{attrs:{span:8}},[n("el-form-item",{attrs:{label:e.$t("Items.PurchaseCost"),prop:"OtherPrice"}},[n("el-input-number",{attrs:{precision:2,step:.1,min:0,max:1500},model:{value:e.tempForm.OtherPrice,callback:function(t){e.$set(e.tempForm,"OtherPrice",t)},expression:"tempForm.OtherPrice"}})],1)],1),e._v(" "),n("el-col",{attrs:{span:8}},[n("el-form-item",{attrs:{label:e.$t("Items.SellingPrice"),prop:"SellingPrice"}},[n("el-input-number",{attrs:{precision:2,step:.1,min:0,max:1500},model:{value:e.tempForm.SellingPrice,callback:function(t){e.$set(e.tempForm,"SellingPrice",t)},expression:"tempForm.SellingPrice"}})],1)],1)],1),e._v(" "),n("el-row",{attrs:{type:"flex"}},[n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:e.$t("Items.LowerOrder"),prop:"LowOrder"}},[n("el-input-number",{attrs:{min:1,max:1e8},model:{value:e.tempForm.LowOrder,callback:function(t){e.$set(e.tempForm,"LowOrder",t)},expression:"tempForm.LowOrder"}})],1)],1),e._v(" "),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:e.$t("Items.Tax"),prop:"Tax"}},[n("el-input-number",{attrs:{precision:2,step:.01,min:.01,max:1},model:{value:e.tempForm.Tax,callback:function(t){e.$set(e.tempForm,"Tax",t)},expression:"tempForm.Tax"}})],1)],1)],1),e._v(" "),n("el-row",{attrs:{type:"flex"}},[n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:e.$t("Items.Barcode"),prop:"Barcode"}},[n("el-input",{attrs:{"suffix-icon":"fa fa-barcode"},model:{value:e.tempForm.Barcode,callback:function(t){e.$set(e.tempForm,"Barcode",t)},expression:"tempForm.Barcode"}})],1)],1),e._v(" "),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:e.$t("Items.Notes"),prop:"description"}},[n("el-input",{attrs:{type:"textarea"},model:{value:e.tempForm.Description,callback:function(t){e.$set(e.tempForm,"Description",t)},expression:"tempForm.Description"}})],1)],1)],1)],1),e._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.Visibles=!1}}},[e._v(e._s(e.$t("permission.cancel")))]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.updateData()}}},[e._v("حفظ")])],1)],1)],1)},I=[],g=(n("c5f6"),{props:{ItemID:{type:Number,default:void 0}},data:function(){return{Visibles:!1,tempForm:{ID:void 0,Name:"",CostPrice:0,SellingPrice:0,OtherPrice:0,LowOrder:0,Tax:0,Rate:0,IsPrime:!1,Barcode:"",Description:""},rulesForm:{Name:[{required:!0,message:"يجب إدخال إسم ",trigger:"blur"},{minlength:3,maxlength:50,message:"الرجاء إدخال إسم لا يقل عن 3 أحرف و لا يزيد عن 50 حرف",trigger:"blur"}]}}},methods:{getdata:function(){var e=this;console.log(this.ItemID),Object(u["GetItemByID"])({ID:this.ItemID}).then((function(t){e.tempForm=t,e.Visibles=!0}))},updateData:function(){var e=this;this.$refs["dataForm"].validate((function(t){if(!t)return console.log("error submit!!"),!1;Object(u["b"])(e.tempForm).then((function(t){e.Visibles=!1,e.$notify({title:"تم",message:"تم التعديل بنجاح",type:"success",duration:2e3})})).catch((function(e){console.log(e)}))}))}}}),x=g,_=Object(v["a"])(x,y,I,!1,null,null,null),F=_.exports,$={name:"NewOrderInventories",components:{ItemsSearch:b,EditItem:F},props:{isEdit:{type:Boolean,default:!1}},data:function(){return{ValidateNote:"",tempForm:{ID:void 0,FakeDate:new Date,OrderType:"ادخال: بضاعة اول المدة / بونص",Description:"",InventoryMovements:[]},rules:{InventoryMovements:[{type:"array",required:!0,message:"لا يمكن إستكمال عملية مخزن من غير إضافة أصناف",trigger:"change"}]},InventoryItems:[],Items:[]}},created:function(){var e=this;this.isEdit&&this.getdata(this.$route.params&&this.$route.params.id),this.tempRoute=Object.assign({},this.$route),Object(s["c"])().then((function(t){console.log(t),e.InventoryItems=t}))},methods:{AddItem:function(e){this.tempForm.InventoryMovements.unshift({ID:void 0,TypeMove:"In",ItemsID:void 0!=e?e.id:void 0,Status:0,Qty:1,SellingPrice:0,Tax:0,Description:"",InventoryItemID:1,Itemx:e,OrderInventoryID:void 0})},Copy:function(e){this.Text=e},Paste:function(e){this.tempForm.InventoryMovements[e].Description=this.Text},getdata:function(e){var t=this;Object(i["d"])({ID:e}).then((function(e){console.log(e),t.tempForm=e,t.setTagsViewTitle(),t.setPageTitle()})).catch((function(e){console.log(e)}))},RemoveItem:function(e){this.tempForm.InventoryMovements.splice(e,1)},createData:function(){var e=this;this.$refs["tempForm"].validate((function(t){if(!t)return console.log("error submit!!"),!1;Object(i["a"])(e.tempForm).then((function(t){e.$notify({title:"تم الإضافة بنجاح",message:"تم الإضافة بنجاح",type:"success",position:"top-left",duration:1e3,showClose:!1,onClose:function(){t&&e.$nextTick((function(){e.$router.replace({path:"/redirect/OrderInventories/List"})}))}})})).catch((function(e){console.log(e)}))}))},updateData:function(){var e=this;this.$refs["tempForm"].validate((function(t){if(!t)return console.log("error submit!!"),!1;Object(i["b"])(e.tempForm).then((function(t){e.$notify({title:"تم تعديل  بنجاح",message:"تم تعديل بنجاح",type:"success",position:"top-left",duration:1e3,showClose:!1,onClose:function(){t&&e.$nextTick((function(){e.$router.replace({path:"/redirect/OrderInventories/List"})}))}})})).catch((function(e){console.log(e)}))}))},setTagsViewTitle:function(){var e="Edit Order Inventory",t=Object.assign({},this.tempRoute,{title:"".concat(e,"-").concat(this.tempForm.id)});this.$store.dispatch("tagsView/updateVisitedView",t)},setPageTitle:function(){var e="Edit Order Inventory";document.title="".concat(e," - ").concat(this.tempForm.id)}}},k=$,O=Object(v["a"])(k,r,o,!1,null,null,null);t["a"]=O.exports},7514:function(e,t,n){"use strict";var r=n("5ca1"),o=n("0a49")(5),i="find",s=!0;i in[]&&Array(1)[i]((function(){s=!1})),r(r.P+r.F*s,"Array",{find:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),n("9c6c")(i)},f815:function(e,t,n){"use strict";n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return c}));var r=n("b7e2"),o=n("4328"),i=n.n(o);function s(e){return Object(r["a"])({url:"/InventoryItem/GetInventoryItem",method:"get",params:e})}function a(e){return Object(r["a"])({url:"/InventoryItem/GetActiveInventory",method:"get",params:e})}function l(e){return Object(r["a"])({url:"/InventoryItem/Create",method:"post",data:i.a.stringify(e)})}function c(e){return Object(r["a"])({url:"/InventoryItem/Edit",method:"post",data:i.a.stringify(e)})}}}]);